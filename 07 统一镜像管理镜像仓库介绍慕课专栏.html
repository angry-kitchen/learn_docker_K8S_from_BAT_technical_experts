<html><head><meta charset="utf-8"><title>07 统一镜像管理：镜像仓库介绍-慕课专栏</title>
			<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
			<meta name="renderer" content="webkit">
			<meta property="qc:admins" content="77103107776157736375">
			<meta property="wb:webmaster" content="c4f857219bfae3cb">
			<meta http-equiv="Access-Control-Allow-Origin" content="*">
			<meta http-equiv="Cache-Control" content="no-transform ">
			<meta http-equiv="Cache-Control" content="no-siteapp">
			<link rel="apple-touch-icon" sizes="76x76" href="https://www.imooc.com/static/img/common/touch-icon-ipad.png">
			<link rel="apple-touch-icon" sizes="120x120" href="https://www.imooc.com/static/img/common/touch-icon-iphone-retina.png">
			<link rel="apple-touch-icon" sizes="152x152" href="https://www.imooc.com/static/img/common/touch-icon-ipad-retina.png">
			<link href="https://moco.imooc.com/captcha/style/captcha.min.css" rel="stylesheet">
			<link rel="stylesheet" href="https://www.imooc.com/static/moco/v1.0/dist/css/moco.min.css?t=201907021539" type="text/css">
			<link rel="stylesheet" href="https://www.imooc.com/static/lib/swiper/swiper-3.4.2.min.css?t=201907021539">
			<link rel="stylesheet" href="https://static.mukewang.com/static/css/??base.css,common/common-less.css?t=2.5,column/zhuanlanChapter-less.css?t=2.5,course/inc/course_tipoff-less.css?t=2.5?v=201907051055" type="text/css">
			<link charset="utf-8" rel="stylesheet" href="https://www.imooc.com/static/lib/ueditor/themes/imooc/css/ueditor.css?v=201907021539"><link rel="stylesheet" href="https://www.imooc.com/static/lib/baiduShare/api/css/share_style0_16.css?v=6aba13f0.css"></head>
			<body><div id="main">


<div class="main-con hide-menu">
    <!-- 左侧菜单 & 索引 -->
    
    <div class="right-content" style="padding-left: 0px;">
        <div class="container clearfix" id="top" style="width: 1134px; display: block;">
            
            
            <div class="center_con js-center_con l" style="width: 1134px;">
                <div class="article-con">
                                            <!-- 买过的阅读 -->
                        

                    
                    <div class="art-title" style="margin-top: 0px;">
                        07 统一镜像管理：镜像仓库介绍
                    </div>
                    <div class="art-info clearfix">
                        
                        <span class="l">
                            更新时间：2020-08-03 09:39:10
                        </span>
                    </div>
                    <div class="art-top">
                                                <img src="https://img4.sycdn.imooc.com/5f16cac600017c7706400426.jpg" alt="">
                                                                        <div class="famous-word-box">
                            <img src="https://www.imooc.com/static/img/column/bg-l.png" alt="" class="bg1 bg">
                            <img src="https://www.imooc.com/static/img/column/bg-r.png" alt="" class="bg2 bg">
                            <div class="famous-word">构成我们学习最大障碍的是已知的东西，而不是未知的东西。 —— 贝尔纳<p></p></div>
                        </div>
                                            </div>
                    <div class="art-content js-lookimg">
                        <div id="article_content">
                            <div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">前面简单提到过 Docker 镜像仓库，这里我们再来详细介绍一下 Docker 的镜像仓库中心，也就是 Docker Registry。本文涉及到的 Registry 主要有三个，由于云厂商的 Registry 大同小异，所以下文中我们将主要介绍官方的 Docker Hub 和使用最多的阿里云的 Docker Registry。</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">官方 Docker Registry，Docker Hub；</li>
<li style="font-size: 20px; line-height: 38px;">阿里云 Docker Registry；</li>
<li style="font-size: 20px; line-height: 38px;">腾讯云 Docker Registry。</li>
</ul>
</div><div class="cl-preview-section"><h2 id="docker-hub" style="font-size: 30px;">1. Docker Hub</h2>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><a href="https://hub.docker.com">Docker Hub</a> 是 Docker 官方提供的 Registry，官网页面如下：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16caec000120f916000858.jpg" data-original="//img1.sycdn.imooc.com/5f16caec000120f916000858.jpg" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">如果我们想要下载 ubuntu 镜像，那么在搜索框输入 ubuntu 进行搜索就得到下面的结果。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16caf40001573627341502.png" data-original="//img1.sycdn.imooc.com/5f16caf40001573627341502.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">其中右侧的黑框中的 <code>docker pull ubuntu</code> 就是镜像的拉取方式。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">Docker Hub 使用起来非常的简单，但是我们一般也只是使用 Docker Hub 来搜索并下载镜像，并不会用来上传存储我们的自定义镜像，这其中的一个主要原因就是网络原因。所以关于 Docker Hub 的镜像上传我们这里就不介绍了。推荐使用云厂商的镜像仓库中心，比如阿里云。</p>
</div><div class="cl-preview-section"><h2 id="阿里云-docker-registry" style="font-size: 30px;">2. 阿里云 Docker Registry</h2>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><a href="https://cn.aliyun.com/product/acr">阿里云的 Docker Registry</a> 可以在容器镜像服务 ACR 中找到。容器镜像服务（简称 ACR，下面都简称为 ACR）提供云原生资产的安全托管和全生命周期管理，支持多场景下镜像的高效分发，与容器服务 ACK 无缝集成，打造云原生应用一站式解决方案。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><strong>ACR</strong> 简化了 Registry 的搭建运维工作，支持多地域的镜像托管，并联合容器服务等云产品，打造云上使用 Docker 的一体化体验。下面是官方网站上面介绍的 ACR 的优势。</p>
</div><div class="cl-preview-section"><h3 id="acr-优势">ACR 优势</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><strong>多架构镜像托管支持</strong></p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">支持 Linux、Windows、ARM 等多架构容器镜像。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><strong>灵活的地域选择</strong></p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">用户可以根据自己的业务需求，选择不同的地域创建和删除镜像仓库。</li>
<li style="font-size: 20px; line-height: 38px;">每个镜像仓库都提供了公网、内网、VPC 网络下对应的网络地址。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><strong>镜像安全扫描</strong></p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">支持便捷的镜像安全扫描功能，展示详细的镜像层信息。</li>
<li style="font-size: 20px; line-height: 38px;">提供镜像漏洞报告，展示漏洞编号、漏洞等级、修复版本等多维度漏洞信息。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><strong>稳定构建服务</strong></p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">支持阿里云 Code、GitHub、Bitbucket、自建 GitLab 的源代码构建源。</li>
<li style="font-size: 20px; line-height: 38px;">支持自动构建，实现源代码变更后自动构建成新 Docker 镜像。</li>
<li style="font-size: 20px; line-height: 38px;">支持海外构建，实现源代码在海外构建成新 Docker 镜像。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><strong>云产品间无缝集成</strong></p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">整合阿里云 Code 及 CodePipeline，实现源代码到应用编译测试后，自动构建成新镜像。</li>
<li style="font-size: 20px; line-height: 38px;">整合容器服务，实现新镜像构建完成后便捷部署至容器服务集群。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">由上面的介绍我们可以看出如果我们最终的容器要运行在阿里云上面，那么阿里云的 Docker Registry 绝对是我们的最佳选择。下面我们就来看一下如何使用。</p>
</div><div class="cl-preview-section"><h3 id="基本介绍">基本介绍</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们直接访问<a href="https://cr.console.aliyun.com/">容器镜像服务控制台 </a> ，会看到如下的一个页面：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16cb000001a4cd23520740.png" data-original="//img1.sycdn.imooc.com/5f16cb000001a4cd23520740.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们首先看到右侧的一个 tab：</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">
<p style="font-size: 20px; line-height: 38px;"><strong>镜像仓库</strong>：比如阿里云上面一个完整的镜像 url 形如 <a href="http://registry.cn-hangzhou.aliyuncs.com/imooc/imooc-demo:v1%EF%BC%8C%E6%9C%80%E5%90%8E%E9%9D%A2%E7%9A%84">registry.cn-hangzhou.aliyuncs.com/imooc/imooc-demo:v1，最后面的</a> imooc-demo 就是镜像仓库。</p>
</li>
<li style="font-size: 20px; line-height: 38px;">
<p style="font-size: 20px; line-height: 38px;"><strong>命名空间</strong>：上面的镜像 url 中的 imooc 就是镜像空间。</p>
</li>
<li style="font-size: 20px; line-height: 38px;">
<p style="font-size: 20px; line-height: 38px;"><strong>授权管理</strong>：是阿里云账号体系相关的，我们可以暂时不用管。</p>
</li>
<li style="font-size: 20px; line-height: 38px;">
<p style="font-size: 20px; line-height: 38px;"><strong>代码源</strong>：构建镜像的代码源，支持阿里云代码管理、Github、Bitbucket、GitLab。除了第一个是阿里云私有的，其他三个都相当于开源的。</p>
</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16cb0800010b1218100608.png" data-original="//img1.sycdn.imooc.com/5f16cb0800010b1218100608.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;"><strong>访问凭证</strong>：我们知道对于私有的 Docker Registry 有一个 docker login 命令需要输入用户名密码，而这个访问凭证就是用来设置 docker login 的密码相关的。可以设置固定密码和临时密码。固定密码相对来说更加方便，但是没有临时密码安全。大家可以根据实际情况使用。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16cb100001d57e21980986.png" data-original="//img1.sycdn.imooc.com/5f16cb100001d57e21980986.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><h3 id="基本设置">基本设置</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">所以要真正使用这个 Docker Registry，我们需要<strong>先创建命名空间和镜像仓库</strong>。我们先创建一个命名空间叫 mooc-demo。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16cb1a0001720516160656.png" data-original="//img1.sycdn.imooc.com/5f16cb1a0001720516160656.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">再创建一个镜像仓库叫 imooc-demo。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16cb230001ceba17341472.png" data-original="//img1.sycdn.imooc.com/5f16cb230001ceba17341472.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">下一步选择本地仓库。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16cb2c000172e415740680.png" data-original="//img1.sycdn.imooc.com/5f16cb2c000172e415740680.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">创建完成之后我们可以看到镜像仓库的详细信息如下。我们可以看到镜像有多个地址：</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">公网地址：很容易理解，就是暴露在公网中。</li>
<li style="font-size: 20px; line-height: 38px;">专有网络：VPC 网络，VPC 可以简单理解一个特定的私有网络。</li>
<li style="font-size: 20px; line-height: 38px;">经典网络：经典网络是在 VPC 网络出来之前的内网，现在已经很少用了。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">内网的好处是不需要上传下载镜像不需要走公网流量，毕竟网络流量收费还挺贵的。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16cb350001f67018781902.png" data-original="//img1.sycdn.imooc.com/5f16cb350001f67018781902.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><h3 id="镜像上传下载">镜像上传下载</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">作为一个 Registry，它的最基本功能肯定是镜像的上传和下载，下面演示一下如何操作。</p>
</div><div class="cl-preview-section"><h5 id="login" style="font-size: 20px; line-height: 38px;">login</h5>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">首先我们需要在本地先 login。</p>
</div><div class="cl-preview-section"><pre class="  language-bash"><code class="prism  language-bash">$ docker login --username<span class="token operator">=</span>xxx registry.cn-hangzhou.aliyuncs.com
Password:
Login Succeeded
</code></pre>
</div><div class="cl-preview-section"><h5 id="tag" style="font-size: 20px; line-height: 38px;">tag</h5>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">要把本地的镜像上传到 Registry，需要将本地镜像重命名成远端镜像的形式，也就是上面截图中的第 3 步的操作。我们将本地的 busybox 镜像上传。</p>
</div><div class="cl-preview-section"><pre class="  language-bash"><code class="prism  language-bash">$ docker tag busybox registry.cn-hangzhou.aliyuncs.com/mooc-demo/imooc-demo:v1
</code></pre>
</div><div class="cl-preview-section"><h5 id="push" style="font-size: 20px; line-height: 38px;">push</h5>
</div><div class="cl-preview-section"><pre class="  language-bash"><code class="prism  language-bash">$ docker push registry.cn-hangzhou.aliyuncs.com/mooc-demo/imooc-demo:v1
The push refers to repository <span class="token punctuation">[</span>registry.cn-hangzhou.aliyuncs.com/mooc-demo/imooc-demo<span class="token punctuation">]</span>
50761fe126b6: Pushed
v1: digest: sha256:2131f09e4044327fd101ca1fd4043e6f3ad921ae7ee901e9142e6e36b354a907 size: 527
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">这就表示上传上去了，我们从页面上面访问看一下。点击左侧的镜像版本可以看到最近的 v1 版本就是我们刚才上传的。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f16cb3f00018f7118140674.png" data-original="//img1.sycdn.imooc.com/5f16cb3f00018f7118140674.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><h2 id="总结" style="font-size: 30px;">3. 总结</h2>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">Docker 镜像仓库中心是我们使用 Docker 中不可或缺的一环。我们需要根据自身的情况选择合适的镜像中心。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">比如我们涉及到容器的所有服务都在阿里云上面，那么镜像仓库中心肯定也使用阿里云的。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">如果我们的容器应用在云上都属于 VPC 网络，那么我的镜像仓库中心也应该使用 VPC 网络。</p>
</div>}
                        </div>
                    </div>
                                            <!-- 买过的阅读 -->
                        <div class="art-next-prev clearfix">
                                                                                                <!-- 已买且开放 或者可以试读 -->
                                    <a href="/read/84/article/2238">
                                                                    <div class="prev l clearfix">
                                        <div class="icon l">
                                            <i class="imv2-arrow3_l"></i>
                                        </div>
                                        <p>
                                            06 葵花宝典：Docker 操作参数详解
                                        </p>
                                    </div>
                                </a>
                                                                                                                            <!-- 已买且开放 或者可以试读 -->
                                    <a href="/read/84/article/2240">
                                                                    <div class="next r clearfix">
                                        <p>
                                            08 站在巨人的肩膀上：热门 Docker 镜像介绍（一）
                                        </p>
                                        <div class="icon r">
                                            <i class="imv2-arrow3_r"></i>
                                        </div>

                                    </div>
                                </a>
                                                    </div>
                                    </div>
                <div class="comments-con js-comments-con" id="coments_con">
                </div>

                
            </div>
            
            
            

        </div>
    </div>
</div>

<div class="modal modal-jiaQun-new hide" id="modal-jiaQun">
    <div class="inner" style="">
        <div class="modal-close js-close-jiaQun">
            <i class="imv2-close"></i>
        </div>
        <div class="content">
            <img src="https://img1.sycdn.imooc.com/5f18f4360001392b05330597.jpg">
            <div class="right-info">
                <div class="title">
                    扫码加入慕课前沿技术核心用户群
                </div>
                <div class="desc">
                                            <p class="mb6">验证信息：<span id="joincode">2011031946279713</span><span class="copy js-copy-joincode">复制</span></p>
                                        <p class="mb6">QQ讨论群号：729941811</p>
                                            <p>QQ群URL：<a href="https://jq.qq.com/?_wv=1027&amp;k=5WJLMxV" target="_blank">点击访问</a></p>
                                    </div>
            </div>
            <p class="tip">若遇到搜索不到QQ群或加群失败，请联系客服邮箱:kf@imooc.com</p>
        </div>
    </div>
</div>
 
<!-- 专栏介绍页专栏评价 -->

<!-- 专栏介绍页底部三条评价 -->

<!-- 专栏阅读页弹层目录和介绍页页面目录 -->

<!-- 专栏阅读页发布回复 -->

<!-- 专栏阅读页发布评论 -->

<!-- 专栏阅读页底部评论 -->

<!-- 专栏阅读 单个 评论 -->

<!-- 新增回复和展开三条以外回复 -->

<!-- 立即订阅的弹窗 -->












</div></body></html>